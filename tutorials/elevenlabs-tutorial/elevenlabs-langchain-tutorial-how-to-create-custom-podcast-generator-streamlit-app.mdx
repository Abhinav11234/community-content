---
title: "ElevenLabs + Langchain Tutorial: Create your own Podcast Generation app using Streamlit."
description: "In this tutorial, we will build a Podcast Generation app using ElevenLabs and Langchain. We will use Streamlit (pure Python framework) to build the web app. Sit back, relax and enjoy the tutorial!"
image: ""
authorUsername: "abdibrokhim"
---


## Introduction
[ElevenLabs](https://beta.elevenlabs.io/about) is voice technology research company, developing the most compelling AI speech software for publishers and creators.
[Langchain](https://python.langchain.com/en/latest/index.html) is a framework for developing applications powered by language models.
[Streamlit](https://streamlit.io/) is pure Python framework for building web apps.


## What are we going to build?
In this tutorial, we will build a Podcast Generation app using ElevenLabs and Langchain. We will use Streamlit (pure Python framework) to build the web app.
Sit back, relax, enjoy the tutorial and don't forget to make a cup of coffee ‚òïÔ∏è.


### Learning outcomes
- Get familiar with ElevenLabs.
- Get familiar with Langchain.
- How to use Streamlit.
- How to build wen apps using Streamlit (pure Python framework).
- Deploy the app on Streamlit.



### Prerequisites
Download [Visual Studio Code](https://code.visualstudio.com/) compatible with your operating system, or use any other code editor like: [IntelliJ IDEA](https://www.jetbrains.com/idea/), [PyCharm](https://www.jetbrains.com/pycharm/), etc.
To use ElevenLabs, we need API key. Go to [ElevenLabs](https://beta.elevenlabs.io/about) and create an account. It's free! üéâ. And in the upper right corner click on your `profile picture` > `profile`. Next click on the eye icon and `copy/save` your API key.
To deploy our app on Streamlit, we need create an account. Go to [Streamlit](https://streamlit.io/) and create an account. It's also free! üéâ.

Nothing more! Just a cup of coffee ‚òïÔ∏è and a laptop üíª.



## Getting started


### Step 1 - Create a new project

Let's start by creating new folder for our project. Open Visual Studio Code and create new folder named `elevenlabs-langchain-tutorial`:

```bash
mkdir elevenlabs-langchain-tutorial
cd elevenlabs-langchain-tutorial
```

### Step 2 - Create a virtual environment and activate it

Next, we need to create a virtual environment and activate it. To do this, run the following command:

```bash
python3 -m venv venv

# on macOS and Linux:
source venv/bin/activate

# on Windows:
venv\Scripts\activate
```

### Step 3 - Install all dependencies

Now, we need to install all dependencies. To do this, run the following command:

```bash
pip install elevenlabs
pip install langchain
pip install openai
pip install streamlit
```

### Step 4 - Implementing podcast generation

In this step, we will use `Langchain` and `OpenAI's ChatGPT-3.5-turbo` to generate podcast. Let's create a new file named `_langchain.py` and add the following code:


```python
# Here we are importing the necessary classes, functions from langchain library.
import openai
from langchain.prompts import (
    ChatPromptTemplate, 
    MessagesPlaceholder, 
    SystemMessagePromptTemplate, 
    HumanMessagePromptTemplate
)
from langchain.chains import ConversationChain
from langchain.chat_models import ChatOpenAI
from langchain.memory import ConversationBufferMemory
import os


# Here we are setting up the OpenAI API key.
os.environ['OPENAI_API_KEY'] = 'api-key'


# Here we are creating a prompt template for the conversation. 
# The prompt template is a list of messages that will be used to generate the conversation.
prompt = ChatPromptTemplate.from_messages([
    SystemMessagePromptTemplate.from_template("The following is a friendly conversation between a human and an AI. The AI is talkative and provides lots of specific details from its context. If the AI does not know the answer to a question, it truthfully says it does not know."),
    MessagesPlaceholder(variable_name="history"),
    HumanMessagePromptTemplate.from_template("{input}")
])


# Here we are creating a LLM (OpenAI in our case).
llm = ChatOpenAI(temperature=0, openai_api_key=os.environ.get("OPENAI_API_KEY"))
memory = ConversationBufferMemory(return_messages=True)
conversation = ConversationChain(memory=memory, prompt=prompt, llm=llm)


# Here we are creating a function to generate a podcast content.
# The function takes three parameters: `prompt`, `podcaster` and `guest`.
# The `prompt` parameter is the topic of the podcast. Ex. Elon Musk joins Lex Fridman in conversation about AI, Autopilot, Neuralink, Tesla, and his personal history.
# The `podcaster` parameter is the name of the podcaster. Ex. Lex Fridman.
# The `guest` parameter is the name of the guest. Ex. Elon Musk.
def get_response(prompt, podcaster, guest):
    _prompt = f"""

    Generate a podcast with {podcaster} and {guest}. They are discussing about {prompt}.
    
    """

    response = conversation.predict(input=_prompt)
    
    return response

```


### Step 5 - Implementing audio podcast generation

In this step, we will use `ElevenLabs` to generate audio for podcast that we already generated in Step 4. Let's create a new file named `_elevenlabs.py` and add the following code:


```python
# Here we are importing the necessary functions from elevenlabs library.
from elevenlabs import clone, generate, play, set_api_key, VOICES_CACHE, voices
from elevenlabs.api import History
import os


# Here we are setting up the ElevenLabs API key.
os.environ['ELEVENLABS_API_KEY'] = 'api-key'
set_api_key(os.environ.get("ELEVENLABS_API_KEY"))


# Here we are creating a function to generate audio for podcast with custom voice. Cool! It helps us to clone the famous people's voices and use them in our podcast.
def with_custom_voice(name, description, prompt, file_path):
    audio_path = 'sample.mp3'

    voice = clone(
        name=name,
        description=description,
        files=[file_path,],
    )

    audio = generate(text=prompt, voice=voice)

    try:
        with open(audio_path, 'wb') as f:
            f.write(audio)

        return audio_path
    
    except Exception as e:
        print(e)
        
        return ""


# Here we are creating a function to generate audio for podcast with premade voice. This voices are already trained and default in ElevenLabs.
def with_premade_voice(prompt, voice):
    audio_path = f'{voice}.mp3'

    audio = generate(
        text=prompt,
        voice=voice,
        model="eleven_monolingual_v1"
    )

    try:
        with open(audio_path, 'wb') as f:
            f.write(audio)

        return audio_path
    
    except Exception as e:
        print(e)

        return ""


# Here we are creating a helper function to get all available voices.
def get_voices():
    names = []

    v_list = voices()

    for v in v_list:
        names.append(v.name)

    return names
```


### Step 6 - Implementing UI

Now, we came to the most interesting part of this tutorial. Here we will use `Streamlit` to create a UI for our podcast generator. Create a new file named `app.py`.

Import the necessary libraries:

```python
# Import from standard library
import os
import logging

# Import from 3rd party libraries
import streamlit as st

# Import modules from the local package
from _langchain import get_response
from _elevenlabs import with_custom_voice, with_premade_voice, get_voices
```

```python
# Configure logger
logging.basicConfig(format="\n%(asctime)s\n%(message)s", level=logging.INFO, force=True)
```



```python
# Configure Streamlit page and state
st.set_page_config(page_title="iPodcast", page_icon="üéß")
```



```python
# Store the initial value of widgets in session state
if "podcast_generate" not in st.session_state:
    st.session_state.podcast_generate = ""

if "file_path" not in st.session_state:
    st.session_state.file_path = ""

if "visibility" not in st.session_state:
    st.session_state.visibility = "visible"
```


```python
# Force responsive layout for columns also on mobile
st.write(
    """
    <style>
    [data-testid="column"] {
        width: calc(50% - 1rem);
        flex: 1 1 calc(50% - 1rem);
        min-width: calc(50% - 1rem);
    }
    </style>
    """,
    unsafe_allow_html=True,
)
```


Render Streamlit page


```python
# Give a title to the app
st.title("Eleven Labs + Langchain Tutorial")
```


```python
# Give a description to the app
st.markdown(
    "This is a demo of the Eleven Labs + Langchain Tutorial."
)
```

```python
file = st.file_uploader(label="Upload file", type=["mp3",])
if file is not None:
    filename = "sample.mp3"
    with open(filename, "wb") as f:
        f.write(file.getbuffer())
    st.session_state.file_path = "sample.mp3"
```


```python
# Create a dropdown.
# Note: `get_voices()` is a helper function that we created in Step 5. It returns all available voices. So we can choose any voice from the dropdown.
voice = st.selectbox('Choose your voice', (i for i in get_voices()))
```


```python
# Create a column layout to make UX better.
col1, col2 = st.columns(2)

# First one is for podcaster name: `Ex. Lex Fridman`.
with col1:
    podcaster = st.text_input(label="Podcaster", placeholder="Ex. Lex Fridman")

# Second one is for guest name: `Ex. Elon Musk`.
with col2:
    guest = st.text_input(label="Guest", placeholder="Ex. Elon Musk")
```


```python
# Create a text area to describe actual podcast topic, information or brief explanation: `Ex. Elon Musk joins Lex Fridman in conversation about AI, Autopilot, Neuralink, Tesla, and his personal history.`.
prompt = st.text_area(label="Podcast info", placeholder="Ex. Elon Musk joins Lex Fridman in conversation about AI, Autopilot, Neuralink, Tesla, and his personal history.", height=100)
```



```python
# Create a button to generate podcast.
st.button(
    label="Generate Podcast",  # name on the button
    help="Click to generate podcast",  # hint text (on hover)
    key="generate_podcast",  # key to be used for the button
    type="primary",  # red default streamlit button
    on_click=generate_podcast,  # function to be called on click
    args=(voice, prompt, podcaster, guest),  # arguments to be passed to the function
)
```

Creating session states.

```python

# Shows loading icon while podcast and audio are being generated
text_spinner_placeholder = st.empty()

# Shows error message if any error occurs
if st.session_state.text_error:
    st.error(st.session_state.text_error)


# Output generated podcast transcription
if st.session_state.podcast_generate:
    st.markdown("""---""")
    st.subheader("Read Podcast")
    st.text_area(label="You may read podcast while audio being generated.", value=st.session_state.podcast_generate,)


# Output generated podcast audio
if st.session_state.file_path:
    st.markdown("""---""")
    st.subheader("Listen to Podcast")

    with open(st.session_state.file_path, "rb") as audio_file:
        audio_bytes = audio_file.read()

    st.audio(audio_bytes, format='audio/mp3', start_time=0)
```

Perfect! Now, we have a fully functional podcast generator web app. Let's run it.

```bash
streamlit run app.py
```

Now, go `http://localhost:8501` or `http://192.168.100.48:8501` to view our Streamlit app.

For better performance, you may install the Watchdog module:

```bash
pip install watchdog
```

Let's try it out!

## Conclusion

Thank you for following along with this tutorial.

If you have any questions, feel free to reach out to me on [LinkedIn](https://linkedin.com/in/abdibrokhim) or [Twitter](https://twitter.com/abdibrokhim). I'd love to hear from you!

made with üíú by [abdibrokhim](https://linkedin.com/in/abdibrokhim) for [lablab.ai tutorials](https://lablab.ai/t).

